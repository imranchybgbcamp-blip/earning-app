<!DOCTYPE html>
<html lang="bn">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>Global Earning BD - High Rate</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" />
<style>
@import url('https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700&display=swap');
:root { --bg: #121212; --card: #1c1c1e; --text: #ffffff; --primary: #0a84ff; --border: #38383a; }
* { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Nunito', sans-serif; }
body { background-color: var(--bg); color: var(--text); padding-bottom: 80px; }
#app { max-width: 500px; margin: 0 auto; }
.profile-header { padding: 20px 15px; display: flex; align-items: center; border-bottom: 1px solid var(--border); }
#user-photo { width: 60px; height: 60px; border-radius: 50%; border: 2px solid var(--primary); margin-right: 15px; }
.page { display: none; padding: 15px; }
.page.active { display: block; animation: fadeIn 0.3s; }
@keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
.stat-card { padding: 20px; border-radius: 12px; text-align: center; background: var(--card); border: 1px solid var(--border); margin-bottom: 15px; }
.stat-card p { font-size: 1.4rem; font-weight: 700; color: var(--primary); }
.task-container { padding: 25px; border-radius: 15px; text-align: center; background: var(--card); border: 1px solid var(--border); margin-bottom: 20px; }
.action-btn { width: 100%; padding: 15px; font-size: 1rem; font-weight: 700; color: #fff; border: none; border-radius: 10px; cursor: pointer; background: var(--primary); }
.action-btn:disabled { background: #444; cursor: not-allowed; }
.input-box { width: 100%; padding: 15px; border-radius: 10px; background: #2c2c2e; border: 1px solid var(--border); color: #fff; margin-bottom: 15px; }
.vpn-notice { background: #ff4500; color: white; padding: 12px; text-align: center; font-weight: bold; border-radius: 8px; margin: 10px; display: none; border: 2px solid #fff; }
.bottom-nav { position: fixed; bottom: 0; width: 100%; max-width: 500px; display: flex; justify-content: space-around; padding: 10px 0; background: var(--card); border-top: 1px solid var(--border); }
.nav-btn { background: none; border: none; color: #8e8e93; font-size: 0.75rem; cursor: pointer; }
.nav-btn.active { color: var(--primary); font-weight: 700; }
.modal { display: none; position: fixed; z-index: 9999; left: 0; top: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); justify-content: center; align-items: center; }
.modal-content { padding: 30px; border-radius: 20px; text-align: center; background: var(--card); width: 85%; border: 1px solid var(--primary); }
#continue-btn { display: none; background: #28a745; margin-top: 15px; }
</style>
</head>
<body>

<div id="app">
    <div id="vpn-warning" class="vpn-notice">
        ‚ö†Ô∏è VPN Required!<br>USA, UK ‡¶¨‡¶æ Canada ‡¶ï‡¶æ‡¶®‡ßá‡¶ï‡ßç‡¶ü ‡¶®‡¶æ ‡¶ï‡¶∞‡¶≤‡ßá ‡¶ï‡¶æ‡¶ú ‡¶ï‡¶∞‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡¶¨‡ßá‡¶® ‡¶®‡¶æ‡•§
    </div>
    
    <header class="profile-header">
        <img id="user-photo" src="https://via.placeholder.com/60">
        <div class="user-details">
            <h1 id="user-name">Loading...</h1>
            <p>Balance: <span id="user-points">0.00</span> TK</p>
        </div>
    </header>

    <main id="main-content" style="display:none;">
        <div id="home-page" class="page active">
            <div style="display:grid; grid-template-columns:1fr 1fr; gap:10px;">
                <div class="stat-card"><h3>Slot</h3><p id="slot-text">0/25</p></div>
                <div class="stat-card"><h3>Total</h3><p id="total-text">0</p></div>
            </div>
            <div class="stat-card">
                <h3>Refer & Earn</h3>
                <input type="text" id="ref-link" readonly style="width:100%; padding:8px; background:none; border:1px dashed #555; color:#fff; text-align:center; margin:10px 0;">
                <button class="action-btn" onclick="copyRef()">Copy Link</button>
            </div>
        </div>

        <div id="tasks-page" class="page">
            <div class="task-container">
                <i class="fas fa-video" style="font-size:3rem; color:var(--primary); margin-bottom:10px;"></i>
                <h3>Watch Ad (0.10 TK)</h3>
                <p id="cooldown-text" style="color:#ff4500; font-size:0.8rem;"></p>
                <button id="watch-ad-btn" class="action-btn">Start Video Ad</button>
            </div>
            <div class="task-container">
                <i class="fab fa-telegram" style="font-size:3rem; color:#24A1DE; margin-bottom:10px;"></i>
                <h3>Join Channel</h3>
                <button id="join-btn" class="action-btn" style="background:#24A1DE;">Join (2 TK)</button>
            </div>
        </div>

        <div id="withdraw-page" class="page">
            <h3>Withdraw</h3>
            <select id="method" class="input-box">
                <option value="Bkash">Bkash</option>
                <option value="Nagad">Nagad</option>
            </select>
            <input type="text" id="acc-num" placeholder="‡¶¨‡¶ø‡¶ï‡¶æ‡¶∂/‡¶®‡¶ó‡¶¶ ‡¶®‡¶æ‡¶Æ‡ßç‡¶¨‡¶æ‡¶∞" class="input-box">
            <input type="number" id="w-amount" placeholder="‡¶Ö‡ßç‡¶Ø‡¶æ‡¶Æ‡¶æ‡¶â‡¶®‡ßç‡¶ü" class="input-box">
            <button class="action-btn" onclick="requestWithdraw()">Confirm Withdraw</button>
        </div>
    </main>

    <nav class="bottom-nav">
        <button class="nav-btn active" data-page="home-page"><i class="fas fa-home"></i><br>Home</button>
        <button class="nav-btn" data-page="tasks-page"><i class="fas fa-tasks"></i><br>Tasks</button>
        <button class="nav-btn" data-page="withdraw-page"><i class="fas fa-wallet"></i><br>Wallet</button>
    </nav>
</div>

<div id="loading-modal" class="modal">
    <div class="modal-content">
        <h3 id="step-title">Step 1: Ad Loading...</h3>
        <p id="timer-text" style="font-size:1.3rem; margin:20px 0; font-weight:bold;">15s</p>
        <button id="continue-btn" class="action-btn">Continue to Step 2</button>
    </div>
</div>

<script src="https://telegram.org/js/telegram-web-app.js"></script>
<script src='https://alwingulla.com/88/pfe/current/tag.min.js?z=10506581' data-cfasync="false" async></script>
<script src='//libtl.com/sdk.js' data-zone='10506581' data-sdk='show_10506581'></script>

<script>
const tg = window.Telegram.WebApp;
const MONETAG_LINK = "https://otieu.com/4/10512972"; 
const ADMIN_ID = "7677039712";
const BOT_TOKEN = "8546793925:AAFs2xfGFkutrydu4TRdVQxxjU1N0g3HaDU";

let state = JSON.parse(localStorage.getItem('user_data')) || { points: 0, ads: 0, total: 0, time: 0, joined: false };

// VPN Check Function
async function checkVPN() {
    try {
        const res = await fetch('https://ipapi.co/json/');
        const data = await res.json();
        const allowed = ['US', 'GB', 'CA', 'AU', 'DE', 'FR']; 
        if (allowed.includes(data.country_code)) {
            document.getElementById('main-content').style.display = 'block';
            document.getElementById('vpn-warning').style.display = 'none';
        } else {
            document.getElementById('vpn-warning').style.display = 'block';
            tg.showAlert("USA/UK/Canada VPN ‡¶ï‡¶æ‡¶®‡ßá‡¶ï‡ßç‡¶ü ‡¶ï‡¶∞‡ßá ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶™‡¶ü‡¶ø ‡¶∞‡¶ø‡¶∏‡ßç‡¶ü‡¶æ‡¶∞‡ßç‡¶ü ‡¶¶‡¶ø‡¶®!");
        }
    } catch (e) {
        document.getElementById('main-content').style.display = 'block'; 
    }
}

function updateUI() {
    document.getElementById('user-points').innerText = state.points.toFixed(2);
    document.getElementById('slot-text').innerText = state.ads + "/25";
    document.getElementById('total-text').innerText = state.total;
    
    const now = Date.now();
    if(state.ads >= 25 && (now - state.time < 10800000)) {
        let diff = Math.ceil((10800000 - (now - state.time)) / 60000);
        document.getElementById('cooldown-text').innerText = `${diff} ‡¶Æ‡¶ø‡¶®‡¶ø‡¶ü ‡¶™‡¶∞ ‡¶Ü‡¶¨‡¶æ‡¶∞ ‡¶Ü‡¶∏‡¶¨‡ßá`;
        document.getElementById('watch-ad-btn').disabled = true;
    } else {
        if(state.ads >= 25) state.ads = 0;
        document.getElementById('cooldown-text').innerText = "";
        document.getElementById('watch-ad-btn').disabled = false;
    }
    localStorage.setItem('user_data', JSON.stringify(state));
}

tg.ready();
const u = tg.initDataUnsafe.user;
if(u) {
    document.getElementById('user-name').innerText = u.first_name;
    document.getElementById('user-photo').src = u.photo_url || 'https://via.placeholder.com/60';
    document.getElementById('ref-link').value = "https://t.me/globalearningbdbot?start=" + u.id;
}

// Watch Ad Logic (15s + 15s)
document.getElementById('watch-ad-btn').onclick = () => {
    if(state.total >= 100) return tg.showAlert("‡¶Ü‡¶ú‡¶ï‡ßá‡¶∞ ‡ßß‡ß¶‡ß¶‡¶ü‡¶ø ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶° ‡¶¶‡ßá‡¶ñ‡¶æ ‡¶∂‡ßá‡¶∑!");
    const modal = document.getElementById('loading-modal');
    const timer = document.getElementById('timer-text');
    const btn = document.getElementById('continue-btn');
    
    modal.style.display = 'flex'; btn.style.display = 'none';
    let s = 15;
    
    show_10506581().catch(()=>{}); 

    const t1 = setInterval(() => {
        s--; timer.innerText = `‡¶Ö‡¶™‡ßá‡¶ï‡ßç‡¶∑‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®: ${s}s`;
        if(s <= 0) { 
            clearInterval(t1); 
            timer.innerText = "Step 1 ‡¶∏‡¶´‡¶≤!"; 
            btn.style.display = 'block'; 
        }
    }, 1000);

    btn.onclick = () => {
        window.open(MONETAG_LINK, '_blank');
        btn.style.display = 'none';
        document.getElementById('step-title').innerText = "Step 2: ‡¶≠‡ßá‡¶∞‡¶ø‡¶´‡¶ø‡¶ï‡ßá‡¶∂‡¶®";
        let s2 = 15;
        const t2 = setInterval(() => {
            s2--; timer.innerText = `‡¶≠‡ßá‡¶∞‡¶ø‡¶´‡¶æ‡¶á ‡¶π‡¶ö‡ßç‡¶õ‡ßá: ${s2}s`;
            if(s2 <= 0) {
                clearInterval(t2); modal.style.display = 'none';
                state.points += 0.10; // ‡ßß‡ß¶ ‡¶™‡ßü‡¶∏‡¶æ ‡¶∞‡ßá‡¶ü
                state.ads++; state.total++;
                if(state.ads === 25) state.time = Date.now();
                updateUI();
                show_10506581('pop').catch(()=>{}); 
                tg.showAlert("‡¶Ö‡¶≠‡¶ø‡¶®‡¶®‡ßç‡¶¶‡¶®! ‡ß¶.‡ßß‡ß¶ ‡¶ü‡¶æ‡¶ï‡¶æ ‡¶Ø‡ßã‡¶ó ‡¶π‡ßü‡ßá‡¶õ‡ßá‡•§");
            }
        }, 1000);
    };
};

async function requestWithdraw() {
    const amount = parseFloat(document.getElementById('w-amount').value);
    const acc = document.getElementById('acc-num').value;
    const method = document.getElementById('method').value;
    if(!amount || amount < 40) return tg.showAlert("‡¶Æ‡¶ø‡¶®‡¶ø‡¶Æ‡¶æ‡¶Æ ‡ß™‡ß¶ ‡¶ü‡¶æ‡¶ï‡¶æ!");
    if(amount > state.points) return tg.showAlert("‡¶¨‡ßç‡¶Ø‡¶æ‡¶≤‡ßá‡¶®‡ßç‡¶∏ ‡¶®‡ßá‡¶á!");
    if(!acc) return tg.showAlert("‡¶®‡¶æ‡¶Æ‡ßç‡¶¨‡¶æ‡¶∞ ‡¶¶‡¶ø‡¶®!");

    const msg = `üí∞ Withdraw Request\nüë§ Name: ${u.first_name}\nüí≥ Method: ${method}\nüìû Number: ${acc}\nüíµ Amount: ${amount} TK`;
    try {
        await fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`, {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify({ chat_id: ADMIN_ID, text: msg })
        });
        state.points -= amount; updateUI(); 
        tg.showAlert("‡¶∞‡¶ø‡¶ï‡ßã‡ßü‡ßá‡¶∏‡ßç‡¶ü ‡¶™‡¶æ‡¶†‡¶æ‡¶®‡ßã ‡¶π‡ßü‡ßá‡¶õ‡ßá!");
    } catch(e) { tg.showAlert("Error!"); }
}

document.querySelectorAll('.nav-btn').forEach(b => {
    b.onclick = () => {
        document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
        document.getElementById(b.dataset.page).classList.add('active');
        document.querySelectorAll('.nav-btn').forEach(n => n.classList.remove('active'));
        b.classList.add('active');
    };
});

function copyRef() {
    navigator.clipboard.writeText(document.getElementById('ref-link').value);
    tg.showAlert("Link Copied!");
}

updateUI();
checkVPN(); // ‡¶≠‡¶ø‡¶™‡¶ø‡¶è‡¶® ‡¶ö‡ßá‡¶ï ‡¶∂‡ßÅ‡¶∞‡ßÅ
</script>
</body>
</html>

<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Global Earning App</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: #121212; color: white; margin: 0; padding: 0; display: flex; flex-direction: column; height: 100vh; overflow: hidden; }
        header { background-color: #1f1f1f; padding: 20px; text-align: center; border-bottom: 2px solid #333; }
        .user-info { display: flex; align-items: center; justify-content: center; gap: 15px; margin-top: 10px; }
        .user-photo { width: 50px; height: 50px; border-radius: 50%; border: 2px solid #007bff; }
        main { flex: 1; overflow-y: auto; padding: 20px; padding-bottom: 80px; }
        .page { display: none; }
        .page.active { display: block; }
        .card { background-color: #1f1f1f; padding: 20px; border-radius: 12px; margin-bottom: 20px; text-align: center; box-shadow: 0 4px 10px rgba(0,0,0,0.3); }
        .btn { background-color: #007bff; color: white; border: none; padding: 12px 25px; border-radius: 8px; cursor: pointer; font-size: 16px; width: 100%; margin-top: 10px; transition: 0.3s; }
        .btn:hover { background-color: #0056b3; }
        nav { position: fixed; bottom: 0; width: 100%; background-color: #1f1f1f; display: flex; justify-content: space-around; padding: 10px 0; border-top: 2px solid #333; }
        nav div { text-align: center; color: #888; cursor: pointer; font-size: 12px; }
        nav div.active { color: #007bff; }
        nav i { font-size: 20px; display: block; margin-bottom: 5px; }
    </style>
</head>
<body>

<header>
    <h2>Global Earning</h2>
    <div class="user-info">
        <img src="https://via.placeholder.com/50" class="user-photo" alt="User">
        <div>
            <div id="user-name">Loading...</div>
            <div id="user-balance">Balance: 0.00 TK</div>
        </div>
    </div>
</header>

<main>
    <div id="home" class="page active">
        <div class="card">
            <h3>Daily Tasks</h3>
            <p>Complete tasks to earn money</p>
            <button class="btn" onclick="showPage('tasks')">Go to Tasks</button>
        </div>
        <div class="card">
            <h3>Refer & Earn</h3>
            <p>Invite friends and get bonus</p>
            <button class="btn" onclick="copyReferLink()">Copy Link</button>
        </div>
    </div>

    <div id="tasks" class="page">
        <div class="card">
            <h3>Watch Video Ad</h3>
            <p>Earn 0.15 TK per ad</p>
            <button class="btn" onclick="watchAd()">Watch Ad</button>
        </div>
        <div class="card">
            <h3>Join Channel</h3>
            <p>Get 5 TK Bonus</p>
            <button class="btn" onclick="window.open('https://t.me/Incometipsbb')">Join Now</button>
        </div>
    </div>

    <div id="withdraw" class="page">
        <div class="card">
            <h3>Withdraw Money</h3>
            <input type="text" id="wallet-number" placeholder="Enter Number" style="width: 90%; padding: 10px; margin: 10px 0; border-radius: 5px; border: none;">
            <select id="method" style="width: 95%; padding: 10px; margin: 10px 0; border-radius: 5px;">
                <option value="Bkash">Bkash</option>
                <option value="Nagad">Nagad</option>
            </select>
            <input type="number" id="amount" placeholder="Amount (Min 20 TK)" style="width: 90%; padding: 10px; margin: 10px 0; border-radius: 5px; border: none;">
            <button class="btn" onclick="submitWithdraw()">Submit Request</button>
        </div>
    </div>
</main>

<nav>
    <div class="active" onclick="showPage('home')"><i class="fas fa-home"></i>Home</div>
    <div onclick="showPage('tasks')"><i class="fas fa-tasks"></i>Tasks</div>
    <div onclick="showPage('withdraw')"><i class="fas fa-wallet"></i>Withdraw</div>
</nav>

<script src="https://telegram.org/js/telegram-web-app.js"></script>
<script src="//libtl.com/sdk.js" data-zone="10506581" data-sdk="show_10506581"></script>

<script>
    const tg = window.Telegram.WebApp;
    tg.expand();

    // --- আপনার তথ্য ---
    const BOT_TOKEN = "8546793925:AAFs2xfGFkutrydu4TRdVQxxjU1N0g3HaDU";
    const ADMIN_CHAT_ID = "7677039712"; 
    
    let balance = parseFloat(localStorage.getItem('balance')) || 0;

    function updateUI() {
        document.getElementById('user-name').innerText = tg.initDataUnsafe.user?.first_name || "User";
        document.getElementById('user-balance').innerText = `Balance: ${balance.toFixed(2)} TK`;
    }

    function showPage(pageId) {
        document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
        document.getElementById(pageId).classList.add('active');
        document.querySelectorAll('nav div').forEach(d => d.classList.remove('active'));
    }

    function watchAd() {
        if (typeof show_10506581 === 'function') {
            show_10506581().then(() => {
                balance += 0.15;
                localStorage.setItem('balance', balance);
                updateUI();
                alert("আপনি ০.১৫ টাকা পেয়েছেন!");
            }).catch(() => alert("Ad failed to load."));
        }
    }

    function submitWithdraw() {
        const number = document.getElementById('wallet-number').value;
        const amount = document.getElementById('amount').value;
        const method = document.getElementById('method').value;

        if (amount < 20 || amount > balance) {
            alert("সঠিক অ্যামাউন্ট দিন (নূন্যতম ২০ টাকা)");
            return;
        }

        const message = `নতুন উইথড্র রিকোয়েস্ট:\nনাম: ${tg.initDataUnsafe.user?.first_name}\nনাম্বার: ${number}\nমেথড: ${method}\nপরিমাণ: ${amount} TK`;
        
        fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage?chat_id=${ADMIN_CHAT_ID}&text=${encodeURIComponent(message)}`)
            .then(res => res.json())
            .then(data => {
                if(data.ok) {
                    balance -= amount;
                    localStorage.setItem('balance', balance);
                    updateUI();
                    alert("রিকোয়েস্ট সফল হয়েছে!");
                } else {
                    alert("Error: বট টোকেন বা আইডি ভুল।");
                }
            });
    }

    updateUI();
</script>
</body>
</html>
